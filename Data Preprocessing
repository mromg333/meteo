import pandas as pd
import numpy as np

csv_file = "2022_2025.csv"
df = pd.read_csv(csv_file, sep=',', encoding='utf-8', low_memory=False)
print("Old Shape:", df.shape)

columns_to_check = ['Wind_Speed[m/s]', 'Hum_Out[%]', 'Temp_Out[degC]']
for column in columns_to_check:
    if column in df.columns:
        df[column] = pd.to_numeric(df[column], errors='coerce')  

      
        mean = df[column].mean()
        std_dev = df[column].std()
        z_scores = (df[column] - mean) / std_dev
        df = df[(z_scores.abs() <= 3)]

        
        print(f"Removed outliers for column: {column} using Z-score")
    else:
        print(f"WARNING: The column '{column}' does not exist in the dataset!")
print("New Shape after removing outliers:", df.shape)


df.to_csv('z1Score.csv', index=False, encoding='utf-8')
print("Saved as 'z1Score.csv'")
